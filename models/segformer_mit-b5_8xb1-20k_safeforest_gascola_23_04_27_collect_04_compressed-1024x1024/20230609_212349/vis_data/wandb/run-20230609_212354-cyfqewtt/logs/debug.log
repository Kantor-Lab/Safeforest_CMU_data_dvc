2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Current SDK version is 0.15.4
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Configure stats pid to 123287
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Loading settings from /home/exouser/.config/wandb/settings
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Loading settings from /ofo-share/repos-david/mmsegmentation_v2/wandb/settings
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'tools/train.py', 'program': 'tools/train.py'}
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_init.py:_log_setup():507] Logging user logs to /ofo-share/repos-david/mmsegmentation_v2/work_dirs/segformer_mit-b5_8xb1-20k_safeforest_gascola_23_04_27_collect_04_compressed-1024x1024/20230609_212349/vis_data/wandb/run-20230609_212354-cyfqewtt/logs/debug.log
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_init.py:_log_setup():508] Logging internal logs to /ofo-share/repos-david/mmsegmentation_v2/work_dirs/segformer_mit-b5_8xb1-20k_safeforest_gascola_23_04_27_collect_04_compressed-1024x1024/20230609_212349/vis_data/wandb/run-20230609_212354-cyfqewtt/logs/debug-internal.log
2023-06-09 21:23:54,691 INFO    MainThread:123287 [wandb_init.py:init():547] calling init triggers
2023-06-09 21:23:54,692 INFO    MainThread:123287 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2023-06-09 21:23:54,692 INFO    MainThread:123287 [wandb_init.py:init():596] starting backend
2023-06-09 21:23:54,692 INFO    MainThread:123287 [wandb_init.py:init():600] setting up manager
2023-06-09 21:23:54,696 INFO    MainThread:123287 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-06-09 21:23:54,700 INFO    MainThread:123287 [wandb_init.py:init():606] backend started and connected
2023-06-09 21:23:54,705 INFO    MainThread:123287 [wandb_init.py:init():703] updated telemetry
2023-06-09 21:23:54,730 INFO    MainThread:123287 [wandb_init.py:init():736] communicating run to backend with 60.0 second timeout
2023-06-09 21:23:54,887 INFO    MainThread:123287 [wandb_run.py:_on_init():2176] communicating current version
2023-06-09 21:23:54,943 INFO    MainThread:123287 [wandb_run.py:_on_init():2185] got version response 
2023-06-09 21:23:54,943 INFO    MainThread:123287 [wandb_init.py:init():787] starting run threads in backend
2023-06-09 21:23:58,008 INFO    MainThread:123287 [wandb_run.py:_console_start():2155] atexit reg
2023-06-09 21:23:58,008 INFO    MainThread:123287 [wandb_run.py:_redirect():2010] redirect: SettingsConsole.WRAP_RAW
2023-06-09 21:23:58,008 INFO    MainThread:123287 [wandb_run.py:_redirect():2075] Wrapping output streams.
2023-06-09 21:23:58,008 INFO    MainThread:123287 [wandb_run.py:_redirect():2100] Redirects installed.
2023-06-09 21:23:58,009 INFO    MainThread:123287 [wandb_init.py:init():828] run started, returning control to user process
2023-06-09 21:23:58,015 INFO    MainThread:123287 [wandb_run.py:_config_callback():1283] config_cb None None {'norm_cfg': {'type': 'SyncBN', 'requires_grad': True}, 'data_preprocessor': {'type': 'SegDataPreProcessor', 'mean': [123.675, 116.28, 103.53], 'std': [58.395, 57.12, 57.375], 'bgr_to_rgb': True, 'pad_val': 0, 'seg_pad_val': 255, 'size': [1024, 1024]}, 'model': {'type': 'EncoderDecoder', 'data_preprocessor': {'type': 'SegDataPreProcessor', 'mean': [123.675, 116.28, 103.53], 'std': [58.395, 57.12, 57.375], 'bgr_to_rgb': True, 'pad_val': 0, 'seg_pad_val': 255, 'size': [1024, 1024]}, 'pretrained': None, 'backbone': {'type': 'MixVisionTransformer', 'in_channels': 3, 'embed_dims': 64, 'num_stages': 4, 'num_layers': [3, 6, 40, 3], 'num_heads': [1, 2, 5, 8], 'patch_sizes': [7, 3, 3, 3], 'sr_ratios': [8, 4, 2, 1], 'out_indices': [0, 1, 2, 3], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_rate': 0.0, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.1, 'init_cfg': {'type': 'Pretrained', 'checkpoint': 'pretrain/mit_b5.pth'}}, 'decode_head': {'type': 'SegformerHead', 'in_channels': [64, 128, 320, 512], 'in_index': [0, 1, 2, 3], 'channels': 256, 'dropout_ratio': 0.1, 'num_classes': 4, 'norm_cfg': {'type': 'SyncBN', 'requires_grad': True}, 'align_corners': False, 'loss_decode': {'type': 'CrossEntropyLoss', 'use_sigmoid': False, 'loss_weight': 1.0}}, 'train_cfg': {}, 'test_cfg': {'mode': 'slide', 'crop_size': [1024, 1024], 'stride': [768, 768]}}, 'dataset_type': 'Safeforest23CompressedDataset', 'data_root': '/ofo-share/repos-david/Safeforest_CMU_data_dvc//data/site_Gascola/04_27_23/collect_04/processed_01/annotations/safeforest23_condensed', 'crop_size': [1024, 1024], 'train_pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations'}, {'type': 'RandomResize', 'scale': [2048, 1024], 'ratio_range': [0.5, 2.0], 'keep_ratio': True}, {'type': 'RandomCrop', 'crop_size': [512, 512], 'cat_max_ratio': 0.75}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'PhotoMetricDistortion'}, {'type': 'PackSegInputs'}], 'test_pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'Resize', 'scale': [2048, 1024], 'keep_ratio': True}, {'type': 'LoadAnnotations'}, {'type': 'PackSegInputs'}], 'img_ratios': [0.5, 0.75, 1.0, 1.25, 1.5, 1.75], 'tta_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'TestTimeAug', 'transforms': [[{'type': 'Resize', 'scale_factor': 0.5, 'keep_ratio': True}, {'type': 'Resize', 'scale_factor': 0.75, 'keep_ratio': True}, {'type': 'Resize', 'scale_factor': 1.0, 'keep_ratio': True}, {'type': 'Resize', 'scale_factor': 1.25, 'keep_ratio': True}, {'type': 'Resize', 'scale_factor': 1.5, 'keep_ratio': True}, {'type': 'Resize', 'scale_factor': 1.75, 'keep_ratio': True}], [{'type': 'RandomFlip', 'prob': 0.0, 'direction': 'horizontal'}, {'type': 'RandomFlip', 'prob': 1.0, 'direction': 'horizontal'}], [{'type': 'LoadAnnotations'}], [{'type': 'PackSegInputs'}]]}], 'train_dataloader': {'batch_size': 1, 'num_workers': 4, 'persistent_workers': True, 'sampler': {'type': 'InfiniteSampler', 'shuffle': True}, 'dataset': {'type': 'Safeforest23CompressedDataset', 'data_root': '/ofo-share/repos-david/Safeforest_CMU_data_dvc//data/site_Gascola/04_27_23/collect_04/processed_01/annotations/safeforest23_condensed', 'data_prefix': {'img_path': 'img_dir/train', 'seg_map_path': 'ann_dir/train'}, 'pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations'}, {'type': 'RandomResize', 'scale': [2048, 1024], 'ratio_range': [0.5, 2.0], 'keep_ratio': True}, {'type': 'RandomCrop', 'crop_size': [512, 512], 'cat_max_ratio': 0.75}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'PhotoMetricDistortion'}, {'type': 'PackSegInputs'}]}}, 'val_dataloader': {'batch_size': 1, 'num_workers': 4, 'persistent_workers': True, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'Safeforest23CompressedDataset', 'data_root': '/ofo-share/repos-david/Safeforest_CMU_data_dvc//data/site_Gascola/04_27_23/collect_04/processed_01/annotations/safeforest23_condensed', 'data_prefix': {'img_path': 'img_dir/val', 'seg_map_path': 'ann_dir/val'}, 'pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'Resize', 'scale': [2048, 1024], 'keep_ratio': True}, {'type': 'LoadAnnotations'}, {'type': 'PackSegInputs'}]}}, 'test_dataloader': {'batch_size': 1, 'num_workers': 4, 'persistent_workers': True, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'Safeforest23CompressedDataset', 'data_root': '/ofo-share/repos-david/Safeforest_CMU_data_dvc//data/site_Gascola/04_27_23/collect_04/processed_01/annotations/safeforest23_condensed', 'data_prefix': {'img_path': 'img_dir/val', 'seg_map_path': 'ann_dir/val'}, 'pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'Resize', 'scale': [2048, 1024], 'keep_ratio': True}, {'type': 'LoadAnnotations'}, {'type': 'PackSegInputs'}]}}, 'val_evaluator': {'type': 'IoUMetric', 'iou_metrics': ['mIoU']}, 'test_evaluator': {'type': 'IoUMetric', 'iou_metrics': ['mIoU']}, 'default_scope': 'mmseg', 'env_cfg': {'cudnn_benchmark': True, 'mp_cfg': {'mp_start_method': 'fork', 'opencv_num_threads': 0}, 'dist_cfg': {'backend': 'nccl'}}, 'vis_backends': [{'type': 'LocalVisBackend'}, {'type': 'WandbVisBackend', 'init_kwargs': {'entity': 'safeforest-cmu', 'project': 'mmsegmentation_gascola', 'name': 'segformer_mit-b0_8xb1-160k_safeforest_gascola_23_04_27_collect_04'}}], 'visualizer': {'type': 'SegLocalVisualizer', 'vis_backends': [{'type': 'LocalVisBackend'}, {'type': 'WandbVisBackend', 'init_kwargs': {'entity': 'safeforest-cmu', 'project': 'mmsegmentation_gascola', 'name': 'segformer_mit-b0_8xb1-160k_safeforest_gascola_23_04_27_collect_04'}}], 'name': 'visualizer'}, 'log_processor': {'by_epoch': False}, 'log_level': 'INFO', 'load_from': None, 'resume': False, 'tta_model': {'type': 'SegTTAModel'}, 'optimizer': {'type': 'SGD', 'lr': 0.01, 'momentum': 0.9, 'weight_decay': 0.0005}, 'optim_wrapper': {'type': 'OptimWrapper', 'optimizer': {'type': 'AdamW', 'lr': 6e-05, 'betas': [0.9, 0.999], 'weight_decay': 0.01}, 'paramwise_cfg': {'custom_keys': {'pos_block': {'decay_mult': 0.0}, 'norm': {'decay_mult': 0.0}, 'head': {'lr_mult': 10.0}}}}, 'param_scheduler': [{'type': 'LinearLR', 'start_factor': 1e-06, 'by_epoch': False, 'begin': 0, 'end': 1500}, {'type': 'PolyLR', 'eta_min': 0.0, 'power': 1.0, 'begin': 1500, 'end': 20000, 'by_epoch': False}], 'train_cfg': {'type': 'IterBasedTrainLoop', 'max_iters': 20000, 'val_interval': 2000}, 'val_cfg': {'type': 'ValLoop'}, 'test_cfg': {'type': 'TestLoop'}, 'default_hooks': {'timer': {'type': 'IterTimerHook'}, 'logger': {'type': 'LoggerHook', 'interval': 50, 'log_metric_by_epoch': False}, 'param_scheduler': {'type': 'ParamSchedulerHook'}, 'checkpoint': {'type': 'CheckpointHook', 'by_epoch': False, 'interval': 2000}, 'sampler_seed': {'type': 'DistSamplerSeedHook'}, 'visualization': {'type': 'SegVisualizationHook'}}, 'launcher': 'none', 'work_dir': './work_dirs/segformer_mit-b5_8xb1-20k_safeforest_gascola_23_04_27_collect_04_compressed-1024x1024'}
2023-06-09 21:24:38,734 WARNING MsgRouterThr:123287 [router.py:message_loop():77] message_loop has been closed
